import{t as D,b as L,n as he}from"../chunks/DC9zYTBi.js";import{i as ke}from"../chunks/CfEB1bgu.js";import{aj as Te,C as Me,I as Z,h as q,aa as Ce,D as Ie,c as k,T as K,F as Se,G as le,J as ee,P as z,ad as Ae,K as pe,M as me,O as Le,ax as re,ah as be,a6 as P,ay as Re,m as B,az as ve,a8 as Ne,aA as Oe,aB as qe,ag as Fe,aC as Be,ak as De,aD as He,aE as $e,ab as Ve,E as ze,aF as Je,aG as Ue,aq as We,j as ye,aH as Ye,aI as Ge,aJ as Ke,aK as Pe,a7 as Qe,n as J,a3 as ue,a4 as fe,a5 as je,aL as Xe,ar as Ze,z as M,B as I,A as T,e as S,x as Q,aM as er,v as rr,at as ar,y as tr}from"../chunks/Br-Lvp4z.js";import{a as sr,w as nr,l as ir,d as or,s as H,e as lr}from"../chunks/BTQ8m3to.js";import{g as ie,p as vr,i as $}from"../chunks/D0M1QHCf.js";import{r as ur}from"../chunks/B5zqRC9x.js";import{s as fr,a as cr}from"../chunks/CB_wTrbj.js";function dr(r,e,a,n){for(var o=[],i=e.length,l=0;l<i;l++)qe(e[l].e,o,!0);var h=i>0&&o.length===0&&a!==null;if(h){var y=a.parentNode;Fe(y),y.append(a),n.clear(),F(r,e[0].prev,e[i-1].next)}Be(o,()=>{for(var p=0;p<i;p++){var t=e[p];h||(n.delete(t.k),F(r,t.prev,t.next)),De(t.e,!h)}})}function ce(r,e,a,n,o,i=null){var l=r,h={flags:e,items:new Map,first:null};{var y=r;l=q?Z(Ce(y)):y.appendChild(Te())}q&&Ie();var p=null,t=!1,b=K(()=>{var s=a();return Ne(s)?s:s==null?[]:be(s)});Me(()=>{var s=k(b),v=s.length;if(t&&v===0)return;t=v===0;let c=!1;if(q){var m=l.data===Se;m!==(v===0)&&(l=le(),Z(l),ee(!1),c=!0)}if(q){for(var w=null,f,d=0;d<v;d++){if(z.nodeType===8&&z.data===Ae){l=z,c=!0,ee(!1);break}var u=s[d],_=n(u,d);f=we(z,h,w,null,u,_,d,o,e,a),h.items.set(_,f),w=f}v>0&&Z(le())}q||_r(s,h,l,o,e,n,a),i!==null&&(v===0?p?pe(p):p=me(()=>i(l)):p!==null&&Le(p,()=>{p=null})),c&&ee(!0),k(b)}),q&&(l=z)}function _r(r,e,a,n,o,i,l){var h=r.length,y=e.items,p=e.first,t=p,b,s=null,v=[],c=[],m,w,f,d;for(d=0;d<h;d+=1){if(m=r[d],w=i(m,d),f=y.get(w),f===void 0){var u=t?t.e.nodes_start:a;s=we(u,e,s,s===null?e.first:s.next,m,w,d,n,o,l),y.set(w,s),v=[],c=[],t=s.next;continue}if(gr(f,m,d),(f.e.f&re)!==0&&pe(f.e),f!==t){if(b!==void 0&&b.has(f)){if(v.length<c.length){var _=c[0],E;s=_.prev;var C=v[0],R=v[v.length-1];for(E=0;E<v.length;E+=1)de(v[E],_,a);for(E=0;E<c.length;E+=1)b.delete(c[E]);F(e,C.prev,R.next),F(e,s,C),F(e,R,_),t=_,s=R,d-=1,v=[],c=[]}else b.delete(f),de(f,t,a),F(e,f.prev,f.next),F(e,f,s===null?e.first:s.next),F(e,s,f),s=f;continue}for(v=[],c=[];t!==null&&t.k!==w;)(t.e.f&re)===0&&(b??(b=new Set)).add(t),c.push(t),t=t.next;if(t===null)continue;f=t}v.push(f),s=f,t=f.next}if(t!==null||b!==void 0){for(var A=b===void 0?[]:be(b);t!==null;)(t.e.f&re)===0&&A.push(t),t=t.next;var O=A.length;if(O>0){var U=h===0?a:null;dr(e,A,U,y)}}P.first=e.first&&e.first.e,P.last=s&&s.e}function gr(r,e,a,n){Re(r.v,e),r.i=a}function we(r,e,a,n,o,i,l,h,y,p){var t=(y&He)!==0,b=(y&$e)===0,s=t?b?B(o):ve(o):o,v=(y&Oe)===0?l:ve(l),c={i:v,v:s,k:i,a:null,e:null,prev:a,next:n};try{return c.e=me(()=>h(r,s,v,p),q),c.e.prev=a&&a.e,c.e.next=n&&n.e,a===null?e.first=c:(a.next=c,a.e.next=c.e),n!==null&&(n.prev=c,n.e.prev=c.e),c}finally{}}function de(r,e,a){for(var n=r.next?r.next.e.nodes_start:a,o=e?e.e.nodes_start:a,i=r.e.nodes_start;i!==n;){var l=Ve(i);o.before(i),i=l}}function F(r,e,a){e===null?r.first=a:(e.next=a,e.e.next=a&&a.e),a!==null&&(a.prev=e,a.e.prev=e&&e.e)}const hr=()=>performance.now(),N={tick:r=>requestAnimationFrame(r),now:()=>hr(),tasks:new Set};function xe(){const r=N.now();N.tasks.forEach(e=>{e.c(r)||(N.tasks.delete(e),e.f())}),N.tasks.size!==0&&N.tick(xe)}function pr(r){let e;return N.tasks.size===0&&N.tick(xe),{promise:new Promise(a=>{N.tasks.add(e={c:r,f:a})}),abort(){N.tasks.delete(e)}}}function W(r,e){nr(()=>{r.dispatchEvent(new CustomEvent(e))})}function mr(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const e=r.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(a=>a[0].toUpperCase()+a.slice(1)).join("")}function _e(r){const e={},a=r.split(";");for(const n of a){const[o,i]=n.split(":");if(!o||i===void 0)break;const l=mr(o.trim());e[l]=i.trim()}return e}const br=r=>r;function Y(r,e,a,n){var o=(r&Ge)!==0,i=(r&Ke)!==0,l=o&&i,h=(r&Ye)!==0,y=l?"both":o?"in":"out",p,t=e.inert,b=e.style.overflow,s,v;function c(){var u=je,_=P;ue(null),fe(null);try{return p??(p=a()(e,(n==null?void 0:n())??{},{direction:y}))}finally{ue(u),fe(_)}}var m={is_global:h,in(){var u;if(e.inert=t,!o){v==null||v.abort(),(u=v==null?void 0:v.reset)==null||u.call(v);return}i||s==null||s.abort(),W(e,"introstart"),s=se(e,c(),v,1,()=>{W(e,"introend"),s==null||s.abort(),s=p=void 0,e.style.overflow=b})},out(u){if(!i){u==null||u(),p=void 0;return}e.inert=!0,W(e,"outrostart"),v=se(e,c(),s,0,()=>{W(e,"outroend"),u==null||u()})},stop:()=>{s==null||s.abort(),v==null||v.abort()}},w=P;if((w.transitions??(w.transitions=[])).push(m),o&&sr){var f=h;if(!f){for(var d=w.parent;d&&(d.f&ze)!==0;)for(;(d=d.parent)&&(d.f&Je)===0;);f=!d||(d.f&Ue)!==0}f&&We(()=>{ye(()=>m.in())})}}function se(r,e,a,n,o){var i=n===1;if(Pe(e)){var l,h=!1;return Qe(()=>{if(!h){var w=e({direction:i?"in":"out"});l=se(r,w,a,n,o)}}),{abort:()=>{h=!0,l==null||l.abort()},deactivate:()=>l.deactivate(),reset:()=>l.reset(),t:()=>l.t()}}if(a==null||a.deactivate(),!(e!=null&&e.duration))return o(),{abort:J,deactivate:J,reset:J,t:()=>n};const{delay:y=0,css:p,tick:t,easing:b=br}=e;var s=[];if(i&&a===void 0&&(t&&t(0,1),p)){var v=_e(p(0,1));s.push(v,v)}var c=()=>1-n,m=r.animate(s,{duration:y});return m.onfinish=()=>{var w=(a==null?void 0:a.t())??1-n;a==null||a.abort();var f=n-w,d=e.duration*Math.abs(f),u=[];if(d>0){var _=!1;if(p)for(var E=Math.ceil(d/16.666666666666668),C=0;C<=E;C+=1){var R=w+f*b(C/E),A=_e(p(R,1-R));u.push(A),_||(_=A.overflow==="hidden")}_&&(r.style.overflow="hidden"),c=()=>{var O=m.currentTime;return w+f*b(O/d)},t&&pr(()=>{if(m.playState!=="running")return!1;var O=c();return t(O,1-O),!0})}m=r.animate(u,{duration:d,fill:"forwards"}),m.onfinish=()=>{c=()=>n,t==null||t(n,1-n),o()}},{abort:()=>{m&&(m.cancel(),m.effect=null,m.onfinish=J)},deactivate:()=>{o=J},reset:()=>{n===0&&(t==null||t(1,0))},t:()=>c()}}function yr(r,e,a=e){var n=Xe();ir(r,"input",o=>{var i=o?r.defaultValue:r.value;if(i=ae(r)?te(i):i,a(i),n&&i!==(i=e())){var l=r.selectionStart,h=r.selectionEnd;r.value=i??"",h!==null&&(r.selectionStart=l,r.selectionEnd=Math.min(h,r.value.length))}}),(q&&r.defaultValue!==r.value||ye(e)==null&&r.value)&&a(ae(r)?te(r.value):r.value),Ze(()=>{var o=e();ae(r)&&o===te(r.value)||r.type==="date"&&!o&&!r.value||o!==r.value&&(r.value=o??"")})}function ae(r){var e=r.type;return e==="number"||e==="range"}function te(r){return r===""?null:+r}const wr=()=>"Live Logs",xr=()=>"Registros en vivo",Er=(r={},e={})=>{const a=e.locale??ie();return a==="en"?wr():a==="es"?xr():"live_logs"},kr=()=>"Run",Tr=()=>"Ejecutar",Mr=(r={},e={})=>{const a=e.locale??ie();return a==="en"?kr():a==="es"?Tr():"run_query"},Cr=()=>"Query Logs",Ir=()=>"Buscar registros",Sr=(r={},e={})=>{const a=e.locale??ie();return a==="en"?Cr():a==="es"?Ir():"query_logs"};function Ar(r,e){S(e,!k(e))}function Lr(r,e,a){k(e)?a():S(e,!0)}var Rr=D('<span class="relative text-xs text-green-400">Copied</span>'),Nr=he('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"></path></svg>'),Or=he('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9h4.5M15 9V4.5M15 9l5.25-5.25M15 15h4.5M15 15v4.5m0-4.5 5.25 5.25"></path></svg>'),qr=D("<pre> </pre>"),Fr=D("<pre> </pre>"),Br=D('<div class="flex items-center gap-1 rounded bg-gray-800 p-2 font-mono text-sm whitespace-pre-wrap transition-all hover:bg-gray-700"><div class="order-last flex self-start"><!> <button aria-label="copy"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"></path></svg></button> <button aria-label="toggle"><!></button></div> <div class="flex-grow truncate" aria-label="expand"><!></div></div>');function ge(r,e){let a=vr(e,"log",8),n=B(!1),o=B(!1);async function i(){const u=JSON.stringify(a());try{await navigator.clipboard.writeText(u),S(o,!0),setTimeout(()=>S(o,!1),1e3)}catch(_){console.error("Failed to copy:",_)}}var l=Br(),h=M(l),y=M(h);{var p=u=>{var _=Rr();L(u,_)};$(y,u=>{k(o)&&u(p)})}var t=I(y,2);t.__click=i;var b=I(t,2);b.__click=[Ar,n];var s=M(b);{var v=u=>{var _=Nr();L(u,_)},c=u=>{var _=Or();L(u,_)};$(s,u=>{k(n)?u(c,!1):u(v)})}T(b),T(h);var m=I(h,2);m.__click=[Lr,n,i];var w=M(m);{var f=u=>{var _=qr(),E=M(_,!0);T(_),Q(C=>H(E,C),[()=>JSON.stringify(a(),null,2)],K),L(u,_)},d=u=>{var _=Fr(),E=M(_,!0);T(_),Q(C=>H(E,C),[()=>JSON.stringify(a())],K),L(u,_)};$(w,u=>{k(n)?u(f):u(d,!1)})}T(m),T(l),L(r,l)}or(["click"]);const Dr=r=>r;function G(r,{delay:e=0,duration:a=400,easing:n=Dr}={}){const o=+getComputedStyle(r).opacity;return{delay:e,duration:a,easing:n,css:i=>`opacity: ${i*o}`}}const ne=er(!0);function Hr(r,{onMessage:e}){let a,n;function o(){a=new WebSocket(r),a.onopen=()=>{ne.set(!0)},a.onmessage=i=>{try{const l=JSON.parse(i.data);e(l)}catch(l){console.error("Error parsing WS message",l)}},a.onclose=()=>{ne.set(!1),n=setTimeout(o,1e3)},a.onerror=i=>{a.close()}}return o(),{close:()=>{clearTimeout(n),a==null||a.close()}}}var $r=D('<div class="rounded border border-red-500 bg-red-900/30 p-2 text-sm text-red-400"><b>Error:</b> </div>'),Vr=D('<div class="rounded border border-green-500 bg-green-900/30 p-2 text-sm text-green-400">Query successful</div>'),zr=D('<div class="mb-2 inline-block rounded bg-red-800/50 px-3 py-1 text-sm text-red-200">Disconnected – attempting to reconnect…</div>'),Jr=D('<div class="grid grid-cols-1 gap-6 lg:grid-cols-2"><div class="space-y-4"><h2 class="mt-4 text-xl font-bold"> </h2> <input class="w-full rounded border border-gray-600 bg-gray-800 p-2" placeholder="SELECT * FROM logs ORDER BY timestamp DESC LIMIT 100"> <div class="space-between flex gap-1"><button class="h-fit rounded bg-blue-600 px-4 py-2 hover:bg-blue-500"> </button> <!></div> <div class="space-y-2 lg:max-h-[75vh] lg:overflow-y-auto"></div></div> <div><h2 class="mb-4 text-xl font-bold"> </h2> <!> <div class="space-y-2 lg:max-h-[90vh] lg:overflow-y-auto"></div></div></div>');function jr(r,e){rr(e,!1);const[a,n]=fr(),o=()=>cr(ne,"$isConnected",a);let i=B("SELECT * FROM logs ORDER BY timestamp DESC LIMIT 10"),l=B([]),h=B([]),y=B(null),p=B(!1);async function t(){S(y,null);try{const g=await fetch(`/query?q=${encodeURIComponent(k(i))}`);if(!g.ok){const x=await g.text();throw new Error(x||"Unknown error")}S(l,await g.json()),setTimeout(()=>{S(p,!0),setTimeout(()=>S(p,!1),2500)},100)}catch(g){S(y,g.message)}}ar(()=>{const g=Hr(`ws://${location.host}/ws`,{onMessage:x=>{S(h,[x,...k(h)].slice(0,100))}});return()=>g.close()}),ke();var b=Jr(),s=M(b),v=M(s),c=M(v,!0);T(v);var m=I(v,2);ur(m);var w=I(m,2),f=M(w),d=M(f,!0);T(f);var u=I(f,2);{var _=g=>{var x=$r(),V=I(M(x));T(x),Q(()=>H(V,` ${k(y)??""}`)),Y(1,x,()=>G,()=>({duration:300})),Y(2,x,()=>G,()=>({duration:100})),L(g,x)},E=(g,x)=>{{var V=j=>{var X=Vr();Y(1,X,()=>G,()=>({duration:300})),Y(2,X,()=>G,()=>({duration:200})),L(j,X)};$(g,j=>{k(p)&&j(V)},x)}};$(u,g=>{k(y)?g(_):g(E,!1)})}T(w);var C=I(w,2);ce(C,5,()=>k(l),g=>g,(g,x)=>{ge(g,{get log(){return k(x)}})}),T(C),T(s);var R=I(s,2),A=M(R),O=M(A,!0);T(A);var U=I(A,2);{var Ee=g=>{var x=zr();L(g,x)};$(U,g=>{o()||g(Ee)})}var oe=I(U,2);ce(oe,5,()=>k(h),g=>g,(g,x)=>{ge(g,{get log(){return k(x)}})}),T(oe),T(R),T(b),Q((g,x,V)=>{H(c,g),H(d,x),H(O,V)},[()=>Sr(),()=>Mr(),()=>Er()],K),yr(m,()=>k(i),g=>S(i,g)),lr("click",f,t),L(r,b),tr(),n()}export{jr as component};
